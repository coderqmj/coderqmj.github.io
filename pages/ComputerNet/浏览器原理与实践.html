<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一、宏观视角的下的浏览器 | coderqmj的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/avatar.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.64f7ac41.css" as="style"><link rel="preload" href="/assets/js/app.922e2828.js" as="script"><link rel="preload" href="/assets/js/2.d7ac843b.js" as="script"><link rel="preload" href="/assets/js/9.b646ca99.js" as="script"><link rel="prefetch" href="/assets/js/10.7b3d9b0c.js"><link rel="prefetch" href="/assets/js/100.486e622c.js"><link rel="prefetch" href="/assets/js/101.d6e1dc74.js"><link rel="prefetch" href="/assets/js/102.7dd0bb36.js"><link rel="prefetch" href="/assets/js/103.c70d0e4e.js"><link rel="prefetch" href="/assets/js/104.6cea9b68.js"><link rel="prefetch" href="/assets/js/105.88d5190c.js"><link rel="prefetch" href="/assets/js/106.0873e8a7.js"><link rel="prefetch" href="/assets/js/107.aca94093.js"><link rel="prefetch" href="/assets/js/108.bca217a4.js"><link rel="prefetch" href="/assets/js/109.5f4a8562.js"><link rel="prefetch" href="/assets/js/11.3db82a7b.js"><link rel="prefetch" href="/assets/js/110.4f43d13c.js"><link rel="prefetch" href="/assets/js/111.12faead2.js"><link rel="prefetch" href="/assets/js/112.6a100fc4.js"><link rel="prefetch" href="/assets/js/113.b635ecb3.js"><link rel="prefetch" href="/assets/js/114.2fc49843.js"><link rel="prefetch" href="/assets/js/115.9bbd97fe.js"><link rel="prefetch" href="/assets/js/116.0111b15f.js"><link rel="prefetch" href="/assets/js/117.2a08ade6.js"><link rel="prefetch" href="/assets/js/118.d5f21bef.js"><link rel="prefetch" href="/assets/js/119.a4028cab.js"><link rel="prefetch" href="/assets/js/12.0d96d9ee.js"><link rel="prefetch" href="/assets/js/120.24ca1007.js"><link rel="prefetch" href="/assets/js/121.cd8ad292.js"><link rel="prefetch" href="/assets/js/122.9e44a8bf.js"><link rel="prefetch" href="/assets/js/123.75a2e13c.js"><link rel="prefetch" href="/assets/js/124.fba7ba6c.js"><link rel="prefetch" href="/assets/js/125.751f3e3f.js"><link rel="prefetch" href="/assets/js/126.6546e225.js"><link rel="prefetch" href="/assets/js/127.e6ffe9f0.js"><link rel="prefetch" href="/assets/js/128.5ba61cba.js"><link rel="prefetch" href="/assets/js/129.5cf13129.js"><link rel="prefetch" href="/assets/js/13.f663b287.js"><link rel="prefetch" href="/assets/js/130.8cf31a88.js"><link rel="prefetch" href="/assets/js/131.a8879ecb.js"><link rel="prefetch" href="/assets/js/132.309606b3.js"><link rel="prefetch" href="/assets/js/133.4ca29821.js"><link rel="prefetch" href="/assets/js/134.5952e738.js"><link rel="prefetch" href="/assets/js/14.f62f380d.js"><link rel="prefetch" href="/assets/js/15.d8470657.js"><link rel="prefetch" href="/assets/js/16.642b34d5.js"><link rel="prefetch" href="/assets/js/17.449c4fca.js"><link rel="prefetch" href="/assets/js/18.979e104a.js"><link rel="prefetch" href="/assets/js/19.58c49ce8.js"><link rel="prefetch" href="/assets/js/20.26fae8f2.js"><link rel="prefetch" href="/assets/js/21.39a99ff9.js"><link rel="prefetch" href="/assets/js/22.f59b98cf.js"><link rel="prefetch" href="/assets/js/23.a92e121d.js"><link rel="prefetch" href="/assets/js/24.6b0ab34d.js"><link rel="prefetch" href="/assets/js/25.59b56b46.js"><link rel="prefetch" href="/assets/js/26.0aa4999f.js"><link rel="prefetch" href="/assets/js/27.e99a8129.js"><link rel="prefetch" href="/assets/js/28.c7dd852e.js"><link rel="prefetch" href="/assets/js/29.999d3392.js"><link rel="prefetch" href="/assets/js/3.1f6a410f.js"><link rel="prefetch" href="/assets/js/30.2efdf158.js"><link rel="prefetch" href="/assets/js/31.82f0b64f.js"><link rel="prefetch" href="/assets/js/32.68df0343.js"><link rel="prefetch" href="/assets/js/33.3a7ea0a7.js"><link rel="prefetch" href="/assets/js/34.687b3b61.js"><link rel="prefetch" href="/assets/js/35.39c120eb.js"><link rel="prefetch" href="/assets/js/36.4449a7d9.js"><link rel="prefetch" href="/assets/js/37.9532964a.js"><link rel="prefetch" href="/assets/js/38.144e8bb9.js"><link rel="prefetch" href="/assets/js/39.2abf6f30.js"><link rel="prefetch" href="/assets/js/4.bdb68f26.js"><link rel="prefetch" href="/assets/js/40.7fac4b90.js"><link rel="prefetch" href="/assets/js/41.9011a251.js"><link rel="prefetch" href="/assets/js/42.8e84c1e4.js"><link rel="prefetch" href="/assets/js/43.419e4228.js"><link rel="prefetch" href="/assets/js/44.79192e61.js"><link rel="prefetch" href="/assets/js/45.4e83ef2a.js"><link rel="prefetch" href="/assets/js/46.536b615b.js"><link rel="prefetch" href="/assets/js/47.81416819.js"><link rel="prefetch" href="/assets/js/48.f1a49526.js"><link rel="prefetch" href="/assets/js/49.901c2a97.js"><link rel="prefetch" href="/assets/js/5.610e1eb4.js"><link rel="prefetch" href="/assets/js/50.148207f2.js"><link rel="prefetch" href="/assets/js/51.317f41c5.js"><link rel="prefetch" href="/assets/js/52.a6cfe0c4.js"><link rel="prefetch" href="/assets/js/53.31c15faa.js"><link rel="prefetch" href="/assets/js/54.86e49cfb.js"><link rel="prefetch" href="/assets/js/55.7e2c8fc0.js"><link rel="prefetch" href="/assets/js/56.699dc67d.js"><link rel="prefetch" href="/assets/js/57.33564c0f.js"><link rel="prefetch" href="/assets/js/58.87b42eb5.js"><link rel="prefetch" href="/assets/js/59.507ceb32.js"><link rel="prefetch" href="/assets/js/6.ec9aaafc.js"><link rel="prefetch" href="/assets/js/60.5a66cc53.js"><link rel="prefetch" href="/assets/js/61.92b1805f.js"><link rel="prefetch" href="/assets/js/62.caf5e68e.js"><link rel="prefetch" href="/assets/js/63.7817522c.js"><link rel="prefetch" href="/assets/js/64.e857c815.js"><link rel="prefetch" href="/assets/js/65.54c955d6.js"><link rel="prefetch" href="/assets/js/66.4dbd3059.js"><link rel="prefetch" href="/assets/js/67.9b678f79.js"><link rel="prefetch" href="/assets/js/68.081769bd.js"><link rel="prefetch" href="/assets/js/69.68a243e0.js"><link rel="prefetch" href="/assets/js/7.7d5d2905.js"><link rel="prefetch" href="/assets/js/70.3cf2db12.js"><link rel="prefetch" href="/assets/js/71.ae28c841.js"><link rel="prefetch" href="/assets/js/72.91f99661.js"><link rel="prefetch" href="/assets/js/73.31290ec1.js"><link rel="prefetch" href="/assets/js/74.3b64e893.js"><link rel="prefetch" href="/assets/js/75.816b9303.js"><link rel="prefetch" href="/assets/js/76.decf1ed4.js"><link rel="prefetch" href="/assets/js/77.d27ebbbb.js"><link rel="prefetch" href="/assets/js/78.2222d4be.js"><link rel="prefetch" href="/assets/js/79.256139d8.js"><link rel="prefetch" href="/assets/js/8.42123a36.js"><link rel="prefetch" href="/assets/js/80.16680d3c.js"><link rel="prefetch" href="/assets/js/81.2f786598.js"><link rel="prefetch" href="/assets/js/82.911631e1.js"><link rel="prefetch" href="/assets/js/83.4cb96d07.js"><link rel="prefetch" href="/assets/js/84.06e4f668.js"><link rel="prefetch" href="/assets/js/85.e77e6e1e.js"><link rel="prefetch" href="/assets/js/86.d2ef0414.js"><link rel="prefetch" href="/assets/js/87.bf848bae.js"><link rel="prefetch" href="/assets/js/88.a52426df.js"><link rel="prefetch" href="/assets/js/89.b57aa852.js"><link rel="prefetch" href="/assets/js/90.f3adce23.js"><link rel="prefetch" href="/assets/js/91.aef49fa5.js"><link rel="prefetch" href="/assets/js/92.b5faa774.js"><link rel="prefetch" href="/assets/js/93.1106a757.js"><link rel="prefetch" href="/assets/js/94.8e0db68a.js"><link rel="prefetch" href="/assets/js/95.18fe0149.js"><link rel="prefetch" href="/assets/js/96.9256b873.js"><link rel="prefetch" href="/assets/js/97.94de60a0.js"><link rel="prefetch" href="/assets/js/98.f196f022.js"><link rel="prefetch" href="/assets/js/99.00436cae.js">
    <link rel="stylesheet" href="/assets/css/0.styles.64f7ac41.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/avatar.png" alt="coderqmj的博客" class="logo"> <span class="site-name can-hide">coderqmj的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/JavaScript/实现拖拽.html" class="nav-link">
  文章
</a></li><li class="dropdown-item"><!----> <a href="/pages/JavaScript/实现拖拽.html" class="nav-link">
  琐碎
</a></li></ul></div></div><div class="nav-item"><a href="https://leetcode-cn.com/u/2vgrNDufDX/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LeetCode
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/coderqmj" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/JavaScript/实现拖拽.html" class="nav-link">
  文章
</a></li><li class="dropdown-item"><!----> <a href="/pages/JavaScript/实现拖拽.html" class="nav-link">
  琐碎
</a></li></ul></div></div><div class="nav-item"><a href="https://leetcode-cn.com/u/2vgrNDufDX/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LeetCode
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/coderqmj" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>计算机网络</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/ComputerNet/HTTP.html" class="sidebar-link">1.HTTP相关</a></li><li><a href="/pages/ComputerNet/七层模型.html" class="sidebar-link">2.七/四/五层模型</a></li><li><a href="/pages/ComputerNet/浏览器缓存.html" class="sidebar-link">浏览器缓存</a></li><li><a href="/pages/ComputerNet/HTTPS.html" class="sidebar-link">HTTPS</a></li><li><a href="/pages/ComputerNet/浏览器安全.html" class="sidebar-link">浏览器安全</a></li><li><a href="/pages/ComputerNet/浏览器性能优化.html" class="sidebar-link">浏览器性能优化</a></li><li><a href="/pages/ComputerNet/HTTP历史.html" class="sidebar-link">HTTP历史</a></li><li><a href="/pages/ComputerNet/HTTP请求流程.html" class="sidebar-link">HTTP请求流程</a></li><li><a href="/pages/ComputerNet/JavaScript如何影响DOM树构建.html" class="sidebar-link">JavaScript如何影响DOM树构建</a></li><li><a href="/pages/ComputerNet/CSS如何影响首次白屏.html" class="sidebar-link">CSS如何影响首次白屏</a></li><li><a href="/pages/ComputerNet/分层合成：为什么CSS比JS高效.html" class="sidebar-link">分层合成：为什么CSS比JS高效</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>VUE</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NODE</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>构建工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构与算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GIT教程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>正则表达式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>三方库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>实习遇到的问题及成长</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>腾讯工作的思考与总结</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>琐碎</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="一、宏观视角的下的浏览器"><a href="#一、宏观视角的下的浏览器" class="header-anchor">#</a> 一、宏观视角的下的浏览器</h1> <h2 id="_1-1打开浏览器-为什么有多个进程"><a href="#_1-1打开浏览器-为什么有多个进程" class="header-anchor">#</a> 1.1打开浏览器，为什么有多个进程</h2> <h4 id="并行处理"><a href="#并行处理" class="header-anchor">#</a> 并行处理</h4> <ul><li>同时处理多个没有依赖的任务</li> <li>就是多线程的原理</li> <li>可以提升效率</li></ul> <h4 id="线程vs进程"><a href="#线程vs进程" class="header-anchor">#</a> 线程VS进程</h4> <ul><li>多线程可以并行处理任务，但是线程是不能单独存在的，他是由进程来启动和管理的。</li> <li>一个进程就是一个程序的运行实例，详细点就是：
<ul><li>启动一个程序，操作系统为该程序新建一块内存，用于存放代码、运行中的数据和一个执行任务的主线程。</li> <li>这样的运行环境叫进程</li></ul></li> <li>进程中任意一个线程出错，都会导致整个进程崩溃</li> <li>线程之间共享进程的数据</li> <li>当一个进程关闭之后，操作系统会回收进程所占用的内存</li> <li>进程之间的内容互相隔离
<ul><li>一个进程崩溃或者挂起，不会影响其他进程</li> <li>如果要通信的话，就涉及到进程间的通信机制了（IPC）</li></ul></li></ul> <h2 id="_1-2tcp协议-如何保证页面文件能被完整送达浏览器"><a href="#_1-2tcp协议-如何保证页面文件能被完整送达浏览器" class="header-anchor">#</a> 1.2TCP协议：如何保证页面文件能被完整送达浏览器？</h2> <p>在衡量Web性能有一个非常重要的指标——<strong>FP（First Paint）</strong>，是<strong>指从页面加载到首次开始绘制的时长</strong>。影响该指标非常重要的一个因素就是<strong>网络加载速度</strong>。</p> <p>想要优化Web页面的加载速度，需要对网络有充分了解。特别是对网络传输协议，不管是HTTP还是Websocket，都是基于TCP/IP的，只有清楚这些原理，才能更好的去优化Web性能，可以轻松定位Web问题。</p> <p>在网络中，一个文件通常会被拆分成很多数据包来进行传输，而在数据包传输的过程中又有很大概率丢失或者出错。<strong>那么如何保证页面文件能被完整的送达浏览器呢？</strong></p> <ul><li>数据包如何送达主机？
<ul><li>互联网都是通过数据包传输数据的，一个文件会被拆分成许多数据包来传输</li></ul></li> <li>主机如何将数据包转交给应用？</li> <li>数据是如何被完整地送达应用程序？</li></ul> <h4 id="_1-数据包如何送达主机"><a href="#_1-数据包如何送达主机" class="header-anchor">#</a> <strong>1.数据包如何送达主机</strong></h4> <ul><li>数据包想要在网上传输，就要符合IP协议，不同在线设备都有唯一的地址，和家里的门牌号一样</li> <li>计算机的地址就是IP，访问任何网站都是你的计算机向另外一台计算机请求信息</li></ul> <p>::: tips</p> <p>把一个数据包从主机A传输到主机B，在传输之前，数据包上会加上主机B的IP地址信息，同时也会主机A自己的IP地址，就跟发快递一样，有发送地址和目标地址。这样才能回复信息。这些信息会被添加进IP头的数据结构里。IP头是IP数据包开头的信息，内容有：<strong>IP版本</strong>、<strong>源IP地址</strong>、<strong>目标IP地址</strong>、<strong>生存时间</strong>等信息。</p> <p>:::</p> <p><img src="/assets/img/IP01.09305381.png" alt=""></p> <p><strong>数据包从主机A到主机B发生了什么</strong></p> <ul><li>应用层将数据包交给网络层</li> <li>网络层将IP头附加到数据包上，组成新的IP数据包，并交给底层</li> <li>底层通过物理网络将数据包传输给主机B</li> <li>数据包传输到主机B的网络层，主机B解析数据包的IP头信息，拆开的数据交给上层</li></ul> <h4 id="_2-udp-把数据包送达应用程序"><a href="#_2-udp-把数据包送达应用程序" class="header-anchor">#</a> 2.UDP：把数据包送达应用程序</h4> <p><strong>为什么要有UDP</strong></p> <ul><li>IP是非常底层的协议，只负责把数据包送达对方电脑，但是不知道送给哪个程序，一条信息过来不知道是给微信还是QQ</li> <li>为此，计算机在IP协议的基础上开发了能和应用打交道的协议——“<strong>用户数据包协议</strong>（User Datagram Protocol）”，简称<strong>UDP</strong>。</li></ul> <p><strong>UDP介绍</strong></p> <ul><li>UDP最重要的信息是端口号，每个想访问网络的程序都要端口号，这样就能把数据精准的送达到某个程序</li> <li>和IP头一样，端口号也会被放进UDP头，UDP头和原始的数据包组合成新的UDP数据包。</li> <li>UDP头除了目的端口，还有源端口号的信息</li></ul> <p><img src="/assets/img/UDP01.ff173250.png" alt=""></p> <p><strong>通过UDP数据包从A主机到B主机发生了什么</strong></p> <ul><li>上层把数据包交给传输层</li> <li>传输层在数据包前面加上UDP头，组成新的UDP数据包，在将新的UDP数据包交给网络层</li> <li>网络层将IP头附加到数据包上，组成新的IP数据包，交给底层</li> <li>数据包传给主机B的网络层，主机B拆开IP头的信息，将拆开的数据包部分交给传输层</li> <li>在B的传输层，数据包中的UDP头会被拆开，并根据UDP中所提供的端口号，把数据部分交给上层的应用程序</li> <li>最后，数据包信息被主机B的应用程序使用</li></ul> <h4 id="tcp-把数据完整地送达应用程序"><a href="#tcp-把数据完整地送达应用程序" class="header-anchor">#</a> TCP：把数据完整地送达应用程序</h4> <ul><li>对于浏览器请求，或者邮件这些重要的信息，传输必须要保证数据的完整性以及可靠性</li> <li>UDP传输存在两个问题：
<ul><li>数据包传输过程中容易丢失</li> <li>大文件拆成小数据包传输，不同时间到达接收端，UDP是不知道如何组装这些数据包的，所以无法还原成完整的数据</li></ul></li> <li>基于这两个问题，可以使用TCP，具有以下特点
<ul><li>对应丢失的数据包，TCP提供了重传机制</li> <li>TCP引入了数据包排序机制，可以把乱序的数据包组合成完整的文件</li> <li>TCP头除了目标端口和本机端口，还有用于排序的序号</li></ul></li></ul> <p><img src="/assets/img/TCP01.2d601c9a.png" alt=""></p> <ul><li>通过上图可以发现TCP单个数据包传输和UDP的流程差不多，不同的是，TCP头部信息保证了一大块数据传输的完整性</li></ul> <p><strong>TCP的生命周期</strong></p> <p><img src="/assets/img/TCP02.419f5ecb.png" alt=""></p> <ul><li>先<strong>建立连接</strong>。通过三次握手建立客户端和服务端的连接。TCP提供面向连接的通信传输。<strong>面向连接</strong>指在数据通信开始之前先做好两端的准备工作。三次握手是指在建立一个TCP连接时，两端总共需要发送三个数据包确认连接的建立</li> <li><strong>传输数据</strong>，传输时，<strong>接收端需要对每个数据包进行确认操作</strong>，当发送端发送一个数据包后，在规定的时间内没有接收到接收端返回的确认消息，就判定为数据包丢失，就会触发发送端的重发机制。然后就是一个大文件会被拆分成许多数据包，到达接收端后会按照TCP头部的序号去组装数据包，<strong>保证了数据的完整性</strong>。</li> <li><strong>断开链接</strong>，数据传输完成，终止连接，涉及到四次挥手保证双方断开连接。</li></ul> <p><strong>总结</strong></p> <ul><li>TCP保证了数据的可靠性，但是牺牲了数据包的传输速度，三次握手和数据包校验机制把传输过程中的数据包数量提高了一倍</li></ul> <h2 id="_1-3-http请求流程-为什么很多站点第二次打开速度会很快"><a href="#_1-3-http请求流程-为什么很多站点第二次打开速度会很快" class="header-anchor">#</a> 1.3 HTTP请求流程：为什么很多站点第二次打开速度会很快？</h2> <p>::: tips</p> <p>HTTP协议是建立在TCP基础上的。<strong>HTTP是一种允许浏览器向服务器获取资源的协议，是Web的基础</strong>。由浏览器发起请求，获取不同类型的资源。</p> <p>:::</p> <ul><li>为什么第一次打开一个站点时，打开速度很慢，再次访问时就变得很快了</li> <li>当登录一个网站之后，下次再访问，就已经是登录状态了，怎么做？</li> <li>上面的特性都和HTTP协议相关</li></ul> <h3 id="浏览器端发起请求"><a href="#浏览器端发起请求" class="header-anchor">#</a> 浏览器端发起请求</h3> <h4 id="_1-构建请求"><a href="#_1-构建请求" class="header-anchor">#</a> 1.构建请求</h4> <ul><li>首先需要构建<strong>请求行</strong>信息，然后浏览器准备发起网络请求</li></ul> <div class="language-http extra-class"><pre class="language-http"><code>GET /index.html HTTP1.1
</code></pre></div><h4 id="_2-查找缓存"><a href="#_2-查找缓存" class="header-anchor">#</a> 2.查找缓存</h4> <ul><li>在发起真正的网络请求之前，浏览器回去查找浏览器缓存中是否有要请求的文件。
<ul><li>如果有，则拦截请求，使用缓存</li> <li>减小了服务器压力，提升了渲染速度</li></ul></li> <li>查找失败则进入网络请求的过程</li></ul> <h4 id="_3-准备ip地址和端口"><a href="#_3-准备ip地址和端口" class="header-anchor">#</a> 3.准备IP地址和端口</h4> <ul><li>需要先了解下HTTP和TCP之间的关系：
<ul><li>浏览器使用HTTP协议作为应用层协议，用于封装请求的文本信息</li> <li>使用TCP/IP作传输层协议将它发到网络上</li> <li>所以HTTP开始工作之前，浏览器通过TCP与服务器建立连接</li> <li>也就是说HTTP的内容是通过TCP的传输数据阶段来实现的</li></ul></li></ul> <p><img src="/assets/img/TCP_HTTP01.e1e78508.png" alt=""></p> <p><strong>思考</strong></p> <ul><li>HTTP网络请求的第一步是什么？与服务器建立连接</li> <li>建立连接需要哪些信息？IP地址和端口号</li> <li>如何获取IP地址和端口号？
<ul><li>根据HTTP请求的话，只有一个URL</li> <li>通过URL可以根据DNS获取到IP</li> <li>端口没有指定默认是80</li></ul></li> <li>其中DNS是负责把域名和IP地址做一一映射关系
<ul><li>DNS的数据可以被缓存，如果某个域名已经解析过了，浏览器可以缓存解析的结果，下一次查询可以直接使用</li></ul></li></ul> <h4 id="_4-等待tcp队列"><a href="#_4-等待tcp队列" class="header-anchor">#</a> 4.等待TCP队列</h4> <ul><li>通过上面步骤IP和端口都有了，但也不能立马就建立连接</li> <li>因为同一个域名最多建立6个TCP连接，也就是该域名同时有10个请求发生，4个请求会进入排队等待状态</li> <li>要是少于6个，那么就进行第5步</li></ul> <h4 id="_5-建立tcp连接"><a href="#_5-建立tcp连接" class="header-anchor">#</a> 5.建立TCP连接</h4> <ul><li>三次握手</li></ul> <h4 id="_6-发送http请求"><a href="#_6-发送http请求" class="header-anchor">#</a> 6.发送HTTP请求</h4> <ul><li>建立连接之后，浏览器就可以向服务器请求数据了</li></ul> <p><img src="/assets/img/HTTP_Request.f310b82d.png" alt=""></p> <p><strong>请求行</strong></p> <ul><li>首先发送请求行，包含了请求方法，请求URI，HTTP版本号</li></ul> <p><strong>请求头</strong></p> <ul><li>把浏览器的基础信息告诉服务器
<ul><li>比如操作系统，浏览器内核，域名信息，浏览器端的Cookie信息</li></ul></li></ul> <h3 id="服务端处理http请求"><a href="#服务端处理http请求" class="header-anchor">#</a> 服务端处理HTTP请求</h3> <h4 id="_1-返回请求"><a href="#_1-返回请求" class="header-anchor">#</a> 1.返回请求</h4> <ul><li>一旦服务器处理结束，便可以返回数据给浏览器了。可以通过curl查看返回的数据</li></ul> <div class="language- extra-class"><pre class="language-text"><code>curl -i  https://time.geekbang.org/
</code></pre></div><ul><li>返回结果如下</li></ul> <p><img src="/assets/img/HTTP_Response.8744ad60.png" alt=""></p> <h4 id="_2-断开连接"><a href="#_2-断开连接" class="header-anchor">#</a> 2.断开连接</h4> <ul><li>一般来说服务端返回请求后就关闭TCP连接，但是浏览器或者服务器在头部信息加上了 <em>Connection:Keep-Alive</em></li> <li>那么TCP连接在发送后任然保持打开状态这样浏览器就可以通过同一个TCP连接发送请求。</li> <li>这样做是为了省去下一次连接所需要的时间，提高了性能，因为复用了该连接</li></ul> <h4 id="_3-重定向"><a href="#_3-重定向" class="header-anchor">#</a> 3.重定向</h4> <ul><li>还有一种情况就是当你在浏览器打开 <em>baidu.com</em>，最后打开页面的地址是 <em>https://baidu.com</em></li> <li>这两个url之所以不一样，是因为涉及到了一个<strong>重定向操作</strong></li> <li>输入 <em>curl -I baidu.com</em>，看看返回什么
<ul><li>返回包含<em>Location: https://baidu.com</em>，代表这会重定向到这个url</li></ul></li></ul> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <h4 id="_1-为什么很多站点第二次打开会很快"><a href="#_1-为什么很多站点第二次打开会很快" class="header-anchor">#</a> 1.为什么很多站点第二次打开会很快</h4> <ul><li>第一次加载页面时，缓存了一些耗时的数据</li> <li>缓存了哪些数据：
<ul><li>DNS缓存和页面资源缓存</li> <li>DNS缓存较为简单，只需把IP和域名对应起来</li></ul></li></ul> <p><img src="/assets/img/huancun_01.9f00d821.png" alt=""></p> <h4 id="_2-如何保持登录状态"><a href="#_2-如何保持登录状态" class="header-anchor">#</a> 2.如何保持登录状态</h4> <ul><li>用户第一次需要向服务器发送post请求提交自己的账号密码</li> <li>服务器接收到信息，回去后台校验，通过后会生成一个标识用户的字符串，写到响应头的Set-Cookie字段里（如 <em>Set-Cookie: UID=3431uad;</em>）</li> <li>浏览器接收到服务器的响应后，开始解析响应头，有Set-Cookie这个字段，浏览器就会把它保存在本地</li> <li>再次访问时，浏览器会发起HTTP请求，但是在发起请求之前，浏览器会读取之前保存的Cookie数据，把数据写进请求头的Cookie字段里，浏览器会把改请求头发给服务器。</li> <li>服务器收到HTTP请求头数据后，会查找请求头是否有Cookie字段，有的话读取字符串，服务器查询后台，判断是登录状态，然后生成包含该用户信息的页面数据，并把生成的数据发送给浏览器</li> <li>浏览器收到该含有当前用户的页面数据后，就可以正确展示用户登录的状态信息了</li></ul> <h2 id="_1-4渲染流程-上-html、css和javascript-是如何变成页面的"><a href="#_1-4渲染流程-上-html、css和javascript-是如何变成页面的" class="header-anchor">#</a> 1.4渲染流程（上）HTML、CSS和JavaScript，是如何变成页面的？</h2> <ul><li>弄清楚渲染流程非常重要</li> <li>优化页面卡顿，JS优化动画流程，优化样式防止强制同步</li></ul> <h3 id="构建dom树"><a href="#构建dom树" class="header-anchor">#</a> 构建DOM树</h3> <ul><li>浏览器无法直接理解和使用HTML，需要将HTML转换为浏览器能直接</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新于:</span> <span class="time">3/4/2022, 3:53:11 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.922e2828.js" defer></script><script src="/assets/js/2.d7ac843b.js" defer></script><script src="/assets/js/9.b646ca99.js" defer></script>
  </body>
</html>
